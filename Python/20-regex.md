# 第20章：正規表現（re）

**この章の目標**  
**正規表現**を使って、文字列の検索・置換・バリデーションを行う方法を学びます。  
実務でよく使うパターンを、初心者向けに説明します。

---

## 正規表現とは？

**正規表現**は、**文字列のパターンを表現する**ための記法です。

- 「メールアドレスっぽい形」「数字だけ」「〇〇で始まる」などを表現できる  
- ログ解析、入力チェック、テキストの一括置換などで使う  
- Python では **re** モジュールで扱う  

---

## 基本的な使い方

```python
import re                          # 正規表現モジュールをインポート

text = "電話番号は 090-1234-5678 です"

# 検索（最初の1件）
match = re.search(r"\d{3}-\d{4}-\d{4}", text)  # パターンに一致する最初の箇所を検索
if match:
    print(match.group())           # 一致した文字列を取得 → 090-1234-5678

# すべて検索
matches = re.findall(r"\d+", text) # パターンに一致するすべてをリストで返す
print(matches)                     # ['090', '1234', '5678']
```

- **r"..."** は Raw 文字列。バックスラッシュをエスケープしなくてよい  
- **\d** は数字1文字、**\d{3}** は数字3桁  

---

## よく使うパターン

| パターン | 意味 |
|----------|------|
| **\d** | 数字（0-9） |
| **\w** | 英数字とアンダースコア |
| **\s** | 空白（スペース、タブなど） |
| **.** | 任意の1文字 |
| **+** | 1回以上 |
| **\*** | 0回以上 |
| **{n}** | ちょうど n 回 |
| **^** | 行頭 |
| **$** | 行末 |

---

## 置換

```python
import re

text = "料金は 1,000 円です"       # カンマを含む文字列
result = re.sub(r",", "", text)   # パターン "," を "" に置換（カンマを削除）
print(result)                     # 料金は 1000 円です
```

- **re.sub(パターン, 置換後, 文字列)** で置換する  

---

## メールアドレスの簡易チェック例

```python
import re

def is_valid_email(email: str) -> bool:
    pattern = r"^[\w\.-]+@[\w\.-]+\.\w+$"
    return bool(re.match(pattern, email))

print(is_valid_email("test@example.com"))  # True
print(is_valid_email("invalid"))           # False
```

---

## まとめ

- **正規表現**で文字列のパターンを表現する。**re** モジュールを使う。
- **search** / **findall** で検索、**sub** で置換。
- **\d**、**\w**、**+**、**\*** などの基本パターンを押さえると実務で使える。
